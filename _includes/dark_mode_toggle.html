<button id="theme-toggle" aria-label="Toggle dark mode" class="theme-toggle">
  <span class="light-mode-icon" style="display: none;">☀️</span>
  <span class="dark-mode-icon" style="display: none;">🌙</span>
</button>

<script>
  (function() {
    const toggleButton = document.getElementById('theme-toggle');
    const htmlElement = document.documentElement;
    const lightIcon = toggleButton.querySelector('.light-mode-icon');
    const darkIcon = toggleButton.querySelector('.dark-mode-icon');

    // Function to set the theme based on a boolean (isDark)
    function setTheme(isDark) {
      htmlElement.classList.toggle('dark', isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      updateToggleIcon(isDark);
    }

    // Function to update the icon display
    function updateToggleIcon(isDark) {
      if (isDark) {
        lightIcon.style.display = 'inline';
        darkIcon.style.display = 'none';
      } else {
        lightIcon.style.display = 'none';
        darkIcon.style.display = 'inline';
      }
    }

    // Initial theme setup on page load
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      setTheme(savedTheme === 'dark');
    } else {
      // Check system preference if no saved theme
      setTheme(window.matchMedia('(prefers-color-scheme: dark)').matches);
    }

    // Event listener for the toggle button
    toggleButton.addEventListener('click', () => {
      const isCurrentlyDark = htmlElement.classList.contains('dark');
      setTheme(!isCurrentlyDark); // Toggle the theme
    });
  })();
</script>
